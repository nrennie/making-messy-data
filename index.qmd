---
title: "Making 'messy' Data: An R Package for Teaching Data Wrangling with Realistic Data"
author:
  - name: Nicola Rennie
    orcid: 0000-0003-4797-557X
    email: "nrennie.research@gmail.com"
    affiliations:
      - name: Lancaster University
        department: Lancaster Medical School
        city: Lancaster
        country: UK
        postal-code: "LA1 4YW"
    attributes:
      corresponding: true
bibliography: references.bib
date: last-modified
format:
  jasa-pdf:
    keep-tex: true
execute: 
  echo: true
  eval: true
  warning: false
keywords:
  - real world data
  - randomness
  - data issues
abstract: "Equipping statistics and data science students with the data wrangling skills necessary to work with real data is essential. Real data can often include typos, missing values encoded in strange ways, unusual spaces in words, or other factors. Example data sets designed for teaching often lack many of these messy properties of real data. At the same time, publicly available real data can be too messy for teaching in a time-constrained environment. This paper presents an R package to modify existing, clean teaching datasets to include a variety of characteristics often found in real data. This allows educators to continue using the same example data sets for teaching, but gives them the opportunity to implicitly teach data wrangling skills, using data with a controlled amount of messiness."
---

```{r}
#| label: make-example-data
#| echo: false
example_data <- tibble::tribble(
  ~month, ~x, ~y,
  "January", 2.21, 1,
  "January", 2.29, 1,
  "January", 1.46, 0,
  "February", 0.55, 1,
  "February", 0.06, 0,
  "February", 0.03, 1,
  "March", 0.11, 1,
  "March", 0.13, 1,
  "April", 0.63, 1,
  "April", 1.39, 0
)
```


## Introduction {#sec-intro}

### Motivation

When teaching examples using R, instructors often using nice datasets - but these aren't very realistic, and aren't what students will later encounter in the real world. Real datasets might contain issues such as typos, missing values encoded in strange ways, or unexpected blank spaces. The {messy} R package takes a clean dataset, and randomly adds these things in - giving students the opportunity to practice their data cleaning and wrangling skills without having to change all of your examples.
often derived from human error or incompatibility between software versions  

why teach data wrangling
why it's hard for teachers

often not a course on data wrangling, students often expected to pick it up as they go along and worse already know how to 
.... highlight the importance of "if an analyst cannot wrangle data in a form to answer a statistical question, their utility may be limited" @Hardin2015

### Existing teaching data

Teaching-specific resources
In R, ... titanic, mtcars, iris, palmerpenguins
toy data, too easy and analyses 
Further, for many widely-used teaching datasets such as `iris` or `titanic`, there are extensive analyses which are publicly available. Though these public analyses may be useful when learning syntax, they also provide temptation for students to bypass the critical thinking and problem-solving skills necessary for real-world data work by using ... or AI-generated ... . Introducing messier, more variable datasets ensures that students engage more with data wrangling processes, rather than relying on pre-existing solutions.

If the aim is to provide students with opportunities to learn how to work with real data, the natural suggestion may be to simply use real data when teaching. @Rivera2019 notes that when teaching using real data, "filtering, aggregating, cleaning, and other preprocessing could be needed; presenting an opportunity to introduce students to data management and data wrangling." However, using real data in teaching presents several challenges. In some cases, real datasets cannot be shared due to ethical concerns, such as those in healthcare. They may also have undergone statistical disclosure control before becoming publicly available, limiting the types of analyses that they can be used to demonstrate. Even when real data can be shared, it is often too complex or messy for instructional use. If data wrangling is not the primary learning objective, students may spend excessive time on preprocessing rather than focusing on analytical concepts. Instructors may spend time pre-cleaning the data to control the amount of messiness, to give a real but ... . Striking a balance between realism and usability is essential to ensure students develop practical skills without being overwhelmed by unnecessary complexity.

other tools for generating data, simulation
R scripts
@McSweeney2024


## Materials and methods {#sec-methods}

### Common data issues

#### Missing values

Missing values are a common ... . Here, we are not concerned with the approach to modellign statsitcs with missing values but rather ...

missing values (represented in different ways) In R [@RCore], but in other ... missing values may be represented as empty strings, the value 999, ... . The way missing values are encoded may also differ between columns. It is essential that students gain practice of identifying and dealing with missing values that are ...., otherwise students risk ... missing missing values.

encoded multiple ways in smae column - different meaning

#### Problems deriving from free text responses

Free text, or survey data that is updated 
encourage visualisation to spot these errors

spaces

case 
- especially when the percentage of typos is small, and not easily spotted by visual inspection


### R package design

Follows tidyverse principles [@tidyverse]

separate functions that can be piped together

wrapper function

random seed

### Types of messiness

missing values 
chnage case
whitespace

### User options

* how missing values represented
* which columns
* amount of messiness

Table of functions and user options

```{r}
#| label: functions
#| message: false
#| echo: false
funcs <- readr::read_csv("functions.csv")
knitr::kable(funcs)
```

## Results {#sec-res}

### Example data

```{r}
#| label: tbl-show-example-data
#| tbl-cap: "Initial clean data set with three columns, including character strings, numeric, and binary variables."
tinytable::tt(example_data, width = 1, theme = "bootstrap")
```


```{r}
#| label: load-pkg
#| message: false
library(messy)
set.seed(1234)
messy(example_data) |> 
  knitr::kable()
```

```{r}
#| label: piping
set.seed(1234)
example_data |> 
  make_missing(cols = "month", missing = " ") |> 
  make_missing(cols = c("x", "y"), missing = c(NA, 999)) |> 
  add_whitespace(cols = "month", messiness = 0.5)
```

### Types of data wrangling tasks



## Discussion {#sec-disc}

though this is an R package, it is useful for other languages. save as csv

also useful for testing functions or r packages

For teachers using ... datasets found online, makes data non-identical and allows teachers 

also useful for classes on modelling missing data

## Conclusion {#sec-conc}

## Supplementary {.unnumbered}

R package [@messy]

## Acknowledgments {.unnumbered}

contributors

## Declaration of interest statement {.unnumbered}

The authors report there are no competing interests to declare.

## Data availability statement {.unnumbered}

The source code for the `messy` R package can be found on GitHub at [github.com/nrennie/messy](https://github.com/nrennie/messy).

## References {.unnumbered}

::: {#refs}
:::



