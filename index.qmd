---
title: "messy: an R package to make example data more realistic"
date: "November 2024"
author:
  - name: Nicola Rennie
    email: "n.rennie@lancaster.ac.uk"
    affiliations:
      - name: Lancaster University
        department: Lancaster Medical School
        city: Lancaster
        country: UK
        postal-code: "LA1 4YW"
bibliography: references.bib
format:
  html: 
    number-sections: true
    number-depth: 3
execute: 
  echo: true
  eval: true
keywords: dataset, real
abstract: "Equipping statistics and data science students with the data wrangling skills necessary to ... . Real data can often include typos, missing values encoded in strange ways, unusual spaces in words, or other factors. Example data sets designed for teaching often lack many of these messy properties of real data, whilst publicly available real data can be too messy or ... . This paper presents an R package to ... . Meaning educators can continue to use the example data sets, but add an opportunity to ... ."
---

```{r}
#| label: make-example-data
#| echo: false
example_data <- tibble::tribble(
  ~month, ~x, ~y,
  "January", 2.21, 1,
  "January", 2.29, 1,
  "January", 1.46, 0,
  "February", 0.55, 1,
  "February", 0.06, 0,
  "February", 0.03, 1,
  "March", 0.11, 1,
  "March", 0.13, 1,
  "April", 0.63, 1,
  "April", 1.39, 0
)
```


::: {.callout-warning}
## To Do

* Draft paper
* Choose examples
* renv

:::





# Introduction

When teaching examples using R, instructors often using nice datasets - but these aren't very realistic, and aren't what students will later encounter in the real world. Real datasets have typos, missing values encoded in strange ways, and weird spaces. The {messy} R package takes a clean dataset, and randomly adds these things in - giving students the opportunity to practice their data cleaning and wrangling skills without having to change all of your examples.
often derived from human error or incompatibility between software versions  

why teach data wrangling
why it's hard for teachers

often not a course on data wrangling, students often expected to pick it up as they go along and worse already know how to 
AI?
.... highlight the importance of "if an analyst cannot wrangle data in a form to answer a statistical question, their utility may be limited" @Hardin2015

toy data, too easy and analyses often easy to obtain online - no opportunity to pratcice data wrangling
real data may not able to share for ethical reasons as in the case of healthcare data. or have undergone stat disclosure - lmiting the type of analysis
real data when can shrae might be too messy - students spending too long on wrangling part if not key objective "Filtering, aggregating, cleaning, and other preprocessing could be needed; presenting an opportunity to introduce students to data management and data wrangling." @Rivera2019
controlled messiness

other tools for generating data 
R scripts
@McSweeney2024

# Materials and methods

## Common data issues

### Missing values

Missing values are a common ... . Here, we are not concerned with the approach to modellign statsitcs with missing values but rather ...

missing values (represented in different ways) In R [@RCore], but in other ... missing values may be represented as empty strings, the value 999, ... . The way missing values are encoded may also differ between columns. It is essential that students gain practice of identifying and dealing with missing values that are ...., otherwise students risk ... missing missing values.

encoded multiple ways in smae column - different meaning

### Probs deriving from ree text

Free text, or survey data that is updated 
encourage visualisation to spot these errors

spaces

case 


## R package design

Follows tidyverse principles [@tidyverse]

separate functions that can be piped together

wrapper function

random seed

## Types of messiness

missing values 
chnage case
whitespace

## User options

* how missing values represented
* which columns
* amount of messiness

Table of functions and user options

```{r}
#| label: functions
#| message: false
#| echo: false
funcs <- readr::read_csv("functions.csv")
knitr::kable(funcs)
```



# Results

## Example data

```{r}
#| label: show-example-data
example_data
```


```{r}
#| label: load-pkg
#| message: false
library(messy)
set.seed(1234)
messy(example_data)
```

```{r}
#| label: piping
set.seed(1234)
example_data |> 
  make_missing(cols = "month", missing = " ") |> 
  make_missing(cols = c("x", "y"), missing = c(NA, 999)) |> 
  add_whitespace(cols = "month", messiness = 0.5)
```


# Discussion

though this is an R package, it is useful for other languages. save as csv

also useful for testing functions or r packages

For teachers using ... datasets found online, makes data non-identical and allows teachers 

also useful for classes on modelling missing data

### Acknowledgments {.unnumbered}

### Declaration of interest statement {.unnumbered}

The authors report there are no competing interests to declare.

### Data availability statement {.unnumbered}

The source code for the `messy` R package can be found on GitHub at [github.com/nrennie/messy](https://github.com/nrennie/messy).

### References {.unnumbered}

::: {#refs}
:::



